<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="color-scheme" content="dark"/>
<title>Da Vinci ‚Äî Cost Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{--bg0:#090b10;--bg1:#0c1017;--card:#0e1420;--border:rgba(148,163,184,.18);--muted:#94a3b8;--text:#e5e7eb;--title:#f8fafc;--red:#dc2626;--amber:#f59e0b;--green:#22c55e;--blue:#3b82f6;--purple:#a855f7;--cyan:#06b6d4;--shadow:0 12px 40px rgba(0,0,0,.45);--radius:16px;--mono:'JetBrains Mono',ui-monospace,monospace;--sans:'Inter',system-ui,sans-serif}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:var(--sans);color:var(--text);background:radial-gradient(1200px 600px at 15% 0%,rgba(220,38,38,.08),transparent 60%),radial-gradient(900px 500px at 95% 10%,rgba(59,130,246,.08),transparent 55%),linear-gradient(180deg,var(--bg0),var(--bg1));min-height:100vh}
.wrap{max-width:1200px;margin:0 auto;padding:24px 16px 40px}
header{display:flex;align-items:flex-start;justify-content:space-between;gap:14px;margin-bottom:24px;flex-wrap:wrap}
h1{font-size:1.5rem;font-weight:700;color:var(--title);letter-spacing:-.02em}
.subtitle{color:var(--muted);font-size:.82rem;margin-top:4px}
h2{font-size:1rem;font-weight:600;color:var(--title);margin-bottom:14px}
.stats-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;margin-bottom:24px}
.stat{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px;box-shadow:var(--shadow)}
.stat-label{font-size:.68rem;color:var(--muted);text-transform:uppercase;letter-spacing:.06em}
.stat-value{font-size:1.5rem;font-weight:700;color:var(--title);font-family:var(--mono);margin-top:2px}
.stat-sub{font-size:.7rem;color:var(--muted);margin-top:3px}
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow);margin-bottom:20px}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
canvas{display:block}
.model-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;margin-bottom:20px}
.mc{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;border-left:3px solid var(--muted)}
.mc.opus{border-left-color:var(--red)}.mc.kimi{border-left-color:var(--blue)}.mc.sonnet{border-left-color:var(--amber)}.mc.gpt4o{border-left-color:var(--green)}.mc.venice{border-left-color:#6b7280}
.mc-name{font-weight:600;font-size:.85rem;color:var(--title);margin-bottom:6px}
.mc-grid{display:grid;grid-template-columns:1fr 1fr;gap:4px;font-size:.72rem}
.mc-grid span{color:var(--muted)}
table{width:100%;border-collapse:collapse;font-size:.78rem}
th{text-align:left;padding:7px 10px;color:var(--muted);font-weight:500;border-bottom:1px solid var(--border);font-size:.68rem;text-transform:uppercase;letter-spacing:.05em}
td{padding:7px 10px;border-bottom:1px solid rgba(148,163,184,.06)}
tr:hover td{background:rgba(148,163,184,.04)}
.mono{font-family:var(--mono);font-size:.75rem}
.cost{color:var(--green);font-weight:600}
.tag{display:inline-block;padding:1px 6px;border-radius:4px;font-size:.65rem;font-weight:600}
.tag-cron{background:rgba(168,85,247,.15);color:var(--purple)}
.tag-int{background:rgba(59,130,246,.15);color:var(--blue)}
.legend{display:flex;gap:14px;flex-wrap:wrap;margin-bottom:10px;font-size:.75rem}
.legend-item{display:flex;align-items:center;gap:5px}
.dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.donut-wrap{display:flex;align-items:center;gap:20px;flex-wrap:wrap}
.donut-legend{display:flex;flex-direction:column;gap:6px;font-size:.75rem}
.alerts{display:flex;flex-direction:column;gap:8px}
.alert{padding:10px 14px;border-radius:8px;font-size:.78rem;display:flex;align-items:center;gap:8px}
.alert.warn{background:#1c1107;border:1px solid #854d0e;color:#fbbf24}
.alert.info{background:#0c1220;border:1px solid #1e3a5f;color:#60a5fa}
.split-bars{display:flex;height:28px;border-radius:6px;overflow:hidden;margin:8px 0}
.split-bar{display:flex;align-items:center;justify-content:center;font-size:.7rem;font-weight:600;color:#fff;transition:width .5s}
@media(max-width:700px){.stats-row{grid-template-columns:1fr 1fr}.model-cards{grid-template-columns:1fr}.grid-2{grid-template-columns:1fr}.donut-wrap{flex-direction:column;align-items:flex-start}}
</style>
</head>
<body>
<div class="wrap">
<header>
<div><h1>üî∫ Da Vinci ‚Äî Cost Dashboard</h1><div class="subtitle">OpenClaw model spend ¬∑ real data from session logs</div></div>
<div style="font-size:.7rem;color:var(--muted)" id="gen-time"></div>
</header>
<div class="stats-row" id="stats"></div>

<div class="card"><h2>Daily Spend</h2>
<div class="legend" id="chart-legend"></div>
<canvas id="dailyChart" height="200"></canvas>
</div>

<h2>Models</h2>
<div class="model-cards" id="models"></div>

<div class="grid-2">
<div class="card"><h2>Provider Split</h2>
<div class="donut-wrap"><canvas id="donut" width="180" height="180" style="width:180px!important;height:180px!important"></canvas><div class="donut-legend" id="plegend"></div></div>
</div>
<div class="card"><h2>Cron vs Interactive</h2>
<div id="split-info"></div>
<div class="split-bars" id="split-bars"></div>
<div id="split-detail" style="font-size:.75rem;color:var(--muted);margin-top:8px"></div>
</div>
</div>

<div class="card"><h2>Top Sessions by Cost</h2>
<table id="sessions-table"><thead><tr><th>Session</th><th>Model</th><th>Cost</th><th>Calls</th><th>Tokens</th><th>Type</th></tr></thead><tbody></tbody></table>
</div>

<div class="card"><h2>Hourly Spend Pattern (UTC)</h2>
<canvas id="hourlyChart" height="100"></canvas>
</div>

<div class="card"><h2>Daily Detail</h2>
<table id="daily-table"><thead><tr><th>Date</th><th>Spend</th><th>Calls</th><th>Top Model</th><th>Trend</th></tr></thead><tbody></tbody></table>
</div>

<h2>Alerts</h2>
<div class="alerts" id="alerts"></div>
</div>

<script>
const D={"generated_at":"2026-02-27","models":{"claude-opus-4-6":{"input":0.005,"output":6.075,"total":101.38,"calls":728,"tokens_in":992,"tokens_out":243012,"cache_read":65064612},"moonshotai/kimi-k2.5":{"input":3.663,"output":0.261,"total":3.925,"calls":290,"tokens_in":6105729,"tokens_out":87154,"cache_read":4449123},"claude-sonnet-4-20250514":{"input":0.0003,"output":0.194,"total":0.943,"calls":27,"tokens_in":92,"tokens_out":12958,"cache_read":1418485},"gpt-4o":{"input":0.121,"output":0.017,"total":0.333,"calls":16,"tokens_in":48569,"tokens_out":1740,"cache_read":155520},"unknown":{"input":0,"output":0,"total":0,"calls":1346,"tokens_in":0,"tokens_out":0,"cache_read":0}},"daily":{"2026-02-17":{"claude-opus-4-6":{"total":0.08,"calls":4}},"2026-02-18":{"claude-opus-4-6":{"total":0.34,"calls":6}},"2026-02-19":{"claude-sonnet-4-20250514":{"total":0.94,"calls":27},"claude-opus-4-6":{"total":0.12,"calls":2}},"2026-02-21":{"gpt-4o":{"total":0.33,"calls":16}},"2026-02-22":{"claude-opus-4-6":{"total":0.13,"calls":2}},"2026-02-23":{"claude-opus-4-6":{"total":0.46,"calls":9}},"2026-02-24":{"claude-opus-4-6":{"total":0.21,"calls":3}},"2026-02-25":{"claude-opus-4-6":{"total":0.62,"calls":13},"moonshotai/kimi-k2.5":{"total":0.08,"calls":4}},"2026-02-26":{"claude-opus-4-6":{"total":64.24,"calls":378},"moonshotai/kimi-k2.5":{"total":2.76,"calls":171}},"2026-02-27":{"claude-opus-4-6":{"total":35.19,"calls":311},"moonshotai/kimi-k2.5":{"total":1.09,"calls":115}}},"providers":{"anthropic":{"total":102.33,"calls":755},"openrouter":{"total":3.93,"calls":290},"openai":{"total":0.33,"calls":16},"unknown":{"total":0,"calls":1346}},"top_sessions":[{"id":"20a2801e","model":"moonshotai/kimi-k2.5","total":91.72,"calls":1210,"tokens_in":0,"tokens_out":0,"is_cron":false,"cron_name":"","day":"2026-02-26"},{"id":"7dbd339a","model":"claude-opus-4-6","total":9.41,"calls":290,"tokens_in":0,"tokens_out":0,"is_cron":false,"cron_name":"","day":"2026-02-27"},{"id":"185f2a0c","model":"claude-opus-4-6","total":1.04,"calls":53,"tokens_in":0,"tokens_out":0,"is_cron":true,"cron_name":"YOLO Nightly Build","day":"2026-02-27"},{"id":"130172b7","model":"claude-sonnet-4-20250514","total":0.94,"calls":54,"tokens_in":0,"tokens_out":0,"is_cron":false,"cron_name":"","day":"2026-02-19"},{"id":"ce3d36ee","model":"claude-opus-4-6","total":0.78,"calls":25,"tokens_in":0,"tokens_out":0,"is_cron":true,"cron_name":"nightly-exploration","day":"2026-02-27"},{"id":"ee4e0ef2","model":"claude-opus-4-6","total":0.55,"calls":14,"tokens_in":0,"tokens_out":0,"is_cron":false,"cron_name":"","day":"2026-02-26"},{"id":"f1fa8a2c","model":"claude-opus-4-6","total":0.46,"calls":10,"tokens_in":0,"tokens_out":0,"is_cron":false,"cron_name":"","day":"2026-02-26"},{"id":"205fb301","model":"claude-opus-4-6","total":0.42,"calls":12,"tokens_in":0,"tokens_out":0,"is_cron":false,"cron_name":"","day":"2026-02-27"},{"id":"e12a7ac8","model":"claude-opus-4-6","total":0.34,"calls":6,"tokens_in":0,"tokens_out":0,"is_cron":false,"cron_name":"","day":"2026-02-18"},{"id":"9cda1d31","model":"moonshotai/kimi-k2.5","total":0.33,"calls":5,"tokens_in":0,"tokens_out":0,"is_cron":true,"cron_name":"morning-briefing","day":"2026-02-26"},{"id":"84d2fea3","model":"moonshotai/kimi-k2.5","total":0.31,"calls":7,"tokens_in":0,"tokens_out":0,"is_cron":true,"cron_name":"daily-security-audit","day":"2026-02-26"},{"id":"b55a2a4e","model":"gpt-4o","total":0.27,"calls":4,"tokens_in":0,"tokens_out":0,"is_cron":false,"cron_name":"","day":"2026-02-21"},{"id":"3f696902","model":"moonshotai/kimi-k2.5","total":0.26,"calls":5,"tokens_in":0,"tokens_out":0,"is_cron":true,"cron_name":"ai-self-improvement-digest","day":"2026-02-27"},{"id":"f8c0ae15","model":"moonshotai/kimi-k2.5","total":0.24,"calls":6,"tokens_in":0,"tokens_out":0,"is_cron":true,"cron_name":"daily-security-audit","day":"2026-02-27"},{"id":"57d90471","model":"moonshotai/kimi-k2.5","total":0.14,"calls":3,"tokens_in":0,"tokens_out":0,"is_cron":true,"cron_name":"daily-workspace-report","day":"2026-02-27"}],"split":{"cron":{"cost":6.86,"calls":890,"sessions":75},"interactive":{"cost":102.75,"calls":1601,"sessions":9}},"hourly":{"0":0.01,"1":0.08,"2":1.82,"3":0,"7":0.95,"8":1.05,"9":5.63,"10":0.05,"11":0.01,"12":0.43,"13":4.37,"14":35.43,"15":12.84,"16":21.68,"17":3.75,"18":0.01,"19":0.89,"20":1.36,"21":14.37,"22":3.22,"23":2.6},"summary":{"total_cost":109.28,"total_calls":2491,"total_sessions":84,"days_tracked":10,"venice_unmetered_calls":1346}};

const C={'claude-opus-4-6':'#dc2626','moonshotai/kimi-k2.5':'#3b82f6','claude-sonnet-4-20250514':'#f59e0b','gpt-4o':'#22c55e','unknown':'#6b7280','anthropic':'#dc2626','openrouter':'#3b82f6','openai':'#22c55e'};
const L={'claude-opus-4-6':'Opus','moonshotai/kimi-k2.5':'Kimi K2.5','claude-sonnet-4-20250514':'Sonnet','gpt-4o':'GPT-4o','unknown':'Venice (unmetered)','anthropic':'Anthropic','openrouter':'OpenRouter','openai':'OpenAI'};
const cl=k=>C[k]||'#525252',lb=k=>L[k]||k;
const $=n=>n.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});
const fN=n=>{if(n>=1e6)return(n/1e6).toFixed(1)+'M';if(n>=1e3)return(n/1e3).toFixed(1)+'K';return n.toLocaleString()};

// Header
const S=D.summary,avg=S.total_cost/S.days_tracked;
document.getElementById('stats').innerHTML=`
<div class="stat"><div class="stat-label">Total Spend</div><div class="stat-value" style="color:var(--red)">$${$(S.total_cost)}</div><div class="stat-sub">${S.days_tracked} days tracked</div></div>
<div class="stat"><div class="stat-label">API Calls</div><div class="stat-value">${fN(S.total_calls)}</div><div class="stat-sub">${S.total_sessions} sessions</div></div>
<div class="stat"><div class="stat-label">Avg Daily</div><div class="stat-value">$${$(avg)}</div><div class="stat-sub">projected ~$${$(avg*30)}/mo</div></div>
<div class="stat"><div class="stat-label">Venice (unmetered)</div><div class="stat-value" style="color:var(--muted)">${fN(S.venice_unmetered_calls)}</div><div class="stat-sub">calls on Venice credits</div></div>`;
document.getElementById('gen-time').textContent='Generated: '+D.generated_at;

// Daily chart
(function(){const cv=document.getElementById('dailyChart'),ctx=cv.getContext('2d'),dpr=window.devicePixelRatio||1,W=cv.parentElement.clientWidth-40,H=200;cv.width=W*dpr;cv.height=H*dpr;cv.style.width=W+'px';cv.style.height=H+'px';ctx.scale(dpr,dpr);
const days=Object.keys(D.daily),models=['claude-opus-4-6','moonshotai/kimi-k2.5','claude-sonnet-4-20250514','gpt-4o'];
let mx=0;days.forEach(d=>{let s=0;models.forEach(m=>{s+=(D.daily[d][m]||{}).total||0});if(s>mx)mx=s});mx=Math.ceil(mx/10)*10||10;
const p={l:55,r:10,t:10,b:30},cW=W-p.l-p.r,cH=H-p.t-p.b,bW=Math.min(36,(cW/days.length)*.7),gap=cW/days.length;
ctx.strokeStyle='rgba(148,163,184,.1)';ctx.lineWidth=1;ctx.font='10px Inter';ctx.fillStyle='#525252';
for(let i=0;i<=4;i++){const y=p.t+cH-(cH*i/4);ctx.beginPath();ctx.moveTo(p.l,y);ctx.lineTo(W-p.r,y);ctx.stroke();ctx.fillText('$'+$(mx*i/4),2,y+3)}
days.forEach((d,i)=>{const x=p.l+i*gap+(gap-bW)/2;let cum=0;models.forEach(m=>{const v=(D.daily[d][m]||{}).total||0;if(v<=0)return;const h=(v/mx)*cH,y=p.t+cH-cum-h;ctx.fillStyle=cl(m);ctx.beginPath();ctx.roundRect(x,y,bW,h,[3,3,0,0]);ctx.fill();cum+=h});ctx.fillStyle='#525252';ctx.font='9px Inter';ctx.textAlign='center';ctx.fillText(d.slice(5),x+bW/2,H-6);ctx.textAlign='left'});
const leg=document.getElementById('chart-legend');models.forEach(m=>{leg.innerHTML+=`<div class="legend-item"><div class="dot" style="background:${cl(m)}"></div>${lb(m)}</div>`})})();

// Model cards
(function(){const c=document.getElementById('models'),cc={'claude-opus-4-6':'opus','moonshotai/kimi-k2.5':'kimi','claude-sonnet-4-20250514':'sonnet','gpt-4o':'gpt4o','unknown':'venice'};
Object.entries(D.models).forEach(([m,d])=>{const pct=S.total_cost>0?((d.total/S.total_cost)*100).toFixed(1):'0';const avg=d.calls>0?d.total/d.calls:0;
c.innerHTML+=`<div class="mc ${cc[m]||''}"><div class="mc-name">${lb(m)}</div><div class="mc-grid"><div><span>Spend:</span> $${$(d.total)}</div><div><span>Share:</span> ${pct}%</div><div><span>Calls:</span> ${fN(d.calls)}</div><div><span>Avg:</span> $${$(avg)}</div><div><span>Tokens in:</span> ${fN(d.tokens_in)}</div><div><span>Tokens out:</span> ${fN(d.tokens_out)}</div>${d.cache_read?`<div><span>Cache:</span> ${fN(d.cache_read)}</div>`:''}</div></div>`})})();

// Donut
(function(){const cv=document.getElementById('donut'),ctx=cv.getContext('2d'),dpr=window.devicePixelRatio||1;cv.width=180*dpr;cv.height=180*dpr;ctx.scale(dpr,dpr);
const provs=Object.entries(D.providers).filter(([k,v])=>v.calls>0),tot=provs.reduce((s,[k,v])=>s+v.calls,0);
let a=-Math.PI/2;provs.forEach(([k,v])=>{const sl=(v.calls/tot)*Math.PI*2;ctx.beginPath();ctx.moveTo(90,90);ctx.arc(90,90,80,a,a+sl);ctx.closePath();ctx.fillStyle=cl(k);ctx.fill();a+=sl});
ctx.beginPath();ctx.arc(90,90,50,0,Math.PI*2);ctx.fillStyle='var(--card)';ctx.fill();ctx.fillStyle='#fff';ctx.font='600 13px Inter';ctx.textAlign='center';ctx.fillText(fN(tot),90,88);ctx.font='10px Inter';ctx.fillStyle='#94a3b8';ctx.fillText('calls',90,104);
const lg=document.getElementById('plegend');provs.forEach(([k,v])=>{lg.innerHTML+=`<div class="legend-item"><div class="dot" style="background:${cl(k)}"></div>${lb(k)}: ${fN(v.calls)} ¬∑ $${$(v.total)}</div>`})})();

// Cron vs Interactive split
(function(){const sp=D.split,tot=sp.cron.cost+sp.interactive.cost;
const cp=tot>0?((sp.cron.cost/tot)*100).toFixed(1):0,ip=tot>0?((sp.interactive.cost/tot)*100).toFixed(1):0;
document.getElementById('split-bars').innerHTML=`<div class="split-bar" style="width:${ip}%;background:var(--blue)">Interactive $${$(sp.interactive.cost)}</div><div class="split-bar" style="width:${Math.max(parseFloat(cp),5)}%;background:var(--purple)">Cron $${$(sp.cron.cost)}</div>`;
document.getElementById('split-detail').innerHTML=`Interactive: ${sp.interactive.sessions} sessions, ${fN(sp.interactive.calls)} calls ¬∑ Cron: ${sp.cron.sessions} sessions, ${fN(sp.cron.calls)} calls`})();

// Top sessions
(function(){const tb=document.querySelector('#sessions-table tbody');
D.top_sessions.forEach(s=>{const tag=s.is_cron?`<span class="tag tag-cron">${s.cron_name||'cron'}</span>`:'<span class="tag tag-int">interactive</span>';
const tok=s.tokens_in+s.tokens_out;
tb.innerHTML+=`<tr><td class="mono">${s.id}</td><td style="color:${cl(s.model)}">${lb(s.model)}</td><td class="mono cost">$${$(s.total)}</td><td>${fN(s.calls)}</td><td>${tok>0?fN(tok):'‚Äî'}</td><td>${tag}</td></tr>`})})();

// Hourly chart
(function(){const cv=document.getElementById('hourlyChart'),ctx=cv.getContext('2d'),dpr=window.devicePixelRatio||1,W=cv.parentElement.clientWidth-40,H=100;cv.width=W*dpr;cv.height=H*dpr;cv.style.width=W+'px';cv.style.height=H+'px';ctx.scale(dpr,dpr);
const hrs=D.hourly,mx=Math.max(...Object.values(hrs))||1;const bW=(W-20)/24;
for(let h=0;h<24;h++){const v=hrs[h]||0;const bH=(v/mx)*(H-20);ctx.fillStyle=v>10?'var(--red)':v>1?'var(--amber)':'var(--blue)';ctx.fillRect(10+h*bW+1,H-15-bH,bW-2,bH);
if(h%3===0){ctx.fillStyle='#525252';ctx.font='8px Inter';ctx.textAlign='center';ctx.fillText(h+'h',10+h*bW+bW/2,H-3)}}})();

// Daily detail
(function(){const tb=document.querySelector('#daily-table tbody');const days=Object.keys(D.daily).sort();let prev=0;
days.forEach((d,i)=>{const ms=D.daily[d];let tot=0,calls=0,top='',topV=0;Object.entries(ms).forEach(([m,v])=>{tot+=v.total;calls+=v.calls;if(v.total>topV){topV=v.total;top=m}});
let tr='';if(i>0){const diff=tot-prev;if(Math.abs(diff)<0.01)tr='<span style="color:#525252">‚Äî</span>';else if(diff>0)tr=`<span style="color:var(--red)">‚ñ≤ +$${$(diff)}</span>`;else tr=`<span style="color:var(--green)">‚ñº $${$(diff)}</span>`}prev=tot;
tb.innerHTML+=`<tr><td>${d}</td><td class="mono" style="font-weight:600;color:var(--title)">$${$(tot)}</td><td>${fN(calls)}</td><td style="color:${cl(top)}">${lb(top)}</td><td>${tr}</td></tr>`})})();

// Alerts
(function(){const al=document.getElementById('alerts');const days=Object.keys(D.daily).sort();
days.forEach(d=>{let t=0;Object.values(D.daily[d]).forEach(v=>t+=v.total);if(t>50)al.innerHTML+=`<div class="alert warn">‚ö†Ô∏è ${d}: Spend exceeded $50 ($${$(t)})</div>`});
const opct=(D.models['claude-opus-4-6'].total/S.total_cost*100).toFixed(1);
if(opct>90)al.innerHTML+=`<div class="alert warn">‚ö†Ô∏è Opus is ${opct}% of total spend ‚Äî consider routing more to Venice sub-agents</div>`;
if(D.models['claude-sonnet-4-20250514']&&D.models['claude-sonnet-4-20250514'].calls>0)al.innerHTML+=`<div class="alert warn">‚ö†Ô∏è ${D.models['claude-sonnet-4-20250514'].calls} direct Anthropic Sonnet calls ($${$(D.models['claude-sonnet-4-20250514'].total)}) should route through Venice</div>`;
al.innerHTML+=`<div class="alert info">‚ÑπÔ∏è ${fN(S.venice_unmetered_calls)} Venice sub-agent calls unmetered ‚Äî check Venice dashboard for credit usage</div>`;
const proj=avg*30;if(proj>500)al.innerHTML+=`<div class="alert warn">‚ö†Ô∏è Projected monthly spend: $${$(proj)} ‚Äî review if sustainable</div>`})();
</script>
</body>
</html>
